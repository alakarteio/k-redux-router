var r,t,e,n,o=(r=require("path-to-regexp"))&&"object"==typeof r&&"default"in r?r.default:r,u={push:function(r,t,e){return{type:"@@router/PUSH",payload:{code:r,params:{path:t,query:e}}}}},a=function(r){return{type:"@@router/ROUTE_FOUND",payload:Object.assign({found:!0},r)}},i=function(r){return function(e){if(window&&window.location&&window.location.pathname){var n,o=r.getState(e.getState()).routes.array.find(function(r){return!!(n=r.href.regexp.exec(window.location.pathname))});n=o.href.parsed.map(function(r){return r.name}).filter(Boolean).reduce(function(r,e,o){return Object.assign(((t={})[e]=n[o+1],t),r)},{}),e.dispatch(a({route:o,params:{path:n,query:function(){var r=window.location;if(r.search.length<2)return{};var t=r.search.substring(1);return JSON.parse('{"'+decodeURI(t).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')}()}}))}}},c=function(r){return function(t){return function(e){var n,o=e.payload;switch(e.type){case"@@router/PUSH":var u=o.code,i=o.params,c=r.getState(t.getState()).routes.map[u];if(c){var s=c.href,f="",d=s.base;s.compiled&&(d=s.compiled(i.path)),i.query&&(f="?"+(n=i.query,Object.keys(n).map(function(r){return encodeURIComponent(r)+"="+encodeURIComponent(n[r])}).join("&"))),window.history.pushState(void 0,void 0,""+d+f)}return a({route:c,params:i});default:return}}}};function s(r){var t=function(t){return function(e){return r(e).routes.map[t]}},e=function(t){return r(t).result},n=function(r){return e(r).params},o=function(r){return n(r).path},u=function(r){return n(r).query},a=function(r){return function(t){return o(t)[r]}},i=function(r){return function(t){return u(t)[r]}};return{getState:r,getRoute:t,getResult:e,getCurrentCode:function(r){return t(r).code},getCurrentRoute:function(r){return e(r).route},isFound:function(r){return e(r).found},getParams:n,getPathParams:o,getQueryParams:u,getPathParam:a,getQueryParam:i,getParam:function(r){return function(t){return a(r)(t)||i(r)(t)}}}}function f(){return{type:"@@router/INIT"}}var d=function(r){return"object"==typeof r&&r.code},p=function(r){var t=[],n=function(r,u,a){var i={};u&&(i=Object.entries(u).filter(function(r){return!d(r[1])}).reduce(function(r,t){return Object.assign(r,((e={})[t[0]]=t[1],e))},{}));var c=a;u&&(c=Object.assign(i,a,{parent:u&&u.code,href:{base:r,compiled:r.includes(":")?o.compile(r):void 0,regexp:o(r),parsed:o.parse(r)}}),t.push(c)),Object.entries(a).filter(function(r){return d(r[1])}).forEach(function(t){var e=t[1];return n([r,t[0]].join("").replace("//","/"),c,e)})};return n("",void 0,r),t.forEach(function(r){Object.entries(r).forEach(function(t){var e=t[0],n=t[1],o=n;d(n)&&(o=n.code),r[e]=o})}),t};exports.actions=u,exports.default=function(r,t){void 0===t&&(t={});var e=t.history;if(!e&&window&&window.history&&(e=window.history),!e)throw new Error("[k-redux-router] no history implementation is given");var o={array:p(r)};o.map=o.array.reduce(function(r,t){return Object.assign({},r,((n={})[t.code]=t,n))},{});var a=function(r,t){var e=Object.assign({},{routes:r,result:{found:!1}}),n=function(r,t){void 0===r&&(r=e),void 0===t&&(t={});var n=t.payload;switch(t.type){case"@@router/ROUTE_FOUND":return Object.assign({},r,{result:n});default:return r}};return Object.assign(n,s(t.getState||function(r){return r.ui.router})),Object.assign(n,u),n}(o,t);return{middleware:function(r,t,e){var n=!1,o=i(e),u=c(e);return function(r){return function(t){return function(e){if(!e.type||!e.type.startsWith("@@router/"))return t(e);var a=t(e);"@@router/INIT"===e.type&&(o(r),n?console.warn("[k-redux-router] initialized twice"):(n=!0,window.onpopstate=function(){o(r)})),n||"@@router/ROUTE_FOUND"===e.type||console.warn("[k-redux-router] router should be initialized");var i=u(r)(e);return i&&r.dispatch(i),a}}}}(0,0,a),reducer:a,init:f}},exports.selectors=s;
//# sourceMappingURL=index.js.map
