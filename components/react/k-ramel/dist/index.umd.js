!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@k-redux-router/core"),require("k-ramel"),require("react"),require("prop-types"),require("@k-ramel/react")):"function"==typeof define&&define.amd?define(["exports","@k-redux-router/core","k-ramel","react","prop-types","@k-ramel/react"],t):t(e["@k-redux-router/react-k-ramel"]={},null,null,e.React,null,null)}(this,function(e,t,r,n,o,u){"use strict";n=n&&n.hasOwnProperty("default")?n.default:n,o=o&&o.hasOwnProperty("default")?o.default:o;var i=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r},f=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},p=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,u=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,u=e}finally{try{!n&&a.return&&a.return()}finally{if(o)throw u}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),d=function(e,t){return function(r){var o,u;return u=o=function(o){function u(r,n){i(this,u);var o=f(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,r,n));return o.toShow=function(){var r=o.context.store.drivers.router;if(r.getState()&&r.getResult()){var n=[].concat(e),u=r.getCurrentRoute();if(t&&t.absolute){var i=n.includes(u.code);i!==o.state.show&&o.setState(function(e){return l({},e,{show:i})})}else{for(var a=n.includes(u.code);u&&u.parent&&!a;)u=r.getRoute(u.parent),a=n.includes(u.code);a!==o.state.show&&o.setState(function(e){return l({},e,{show:a})})}}else console.error("[k-redux-router] | There is no route found in `state.ui.router.result`")},o.state={show:!1},o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(u,n.Component),a(u,[{key:"componentWillMount",value:function(){var e=this;this.unsubscribe=this.context.store.subscribe(function(){e.toShow()}),this.toShow()}},{key:"componentWillUnmount",value:function(){this.unsubscribe()}},{key:"render",value:function(){return this.state.show?n.createElement(r,this.props):null}}]),u}(),o.displayName=function(e){return"router("+(e.displayName||e.name||e.constructor&&e.constructor.name||"Unknown")+")"}(r),o.contextTypes={store:function(){return null}},u}};d.absolute=function(e,t){return d(e,l({},t,{absolute:!0}))};var h=function(e){var t=e.href,r=e.onClick,o=s(e,["href","onClick"]),u=o.className,i=o.children;if(void 0===t)return null;var a,c="",l=t;return t.base&&(l=t.base),t.compiled&&(l=t.compiled(o)),o.query&&(c="?"+(a=o.query,Object.keys(a).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(a[e])}).join("&"))),l=""+l+c,n.createElement("a",{className:u,href:l,onClick:r},i)};h.propTypes={className:o.string,children:o.node,href:o.oneOfType([o.string,o.shape({base:o.string,compiled:o.func})]),onClick:o.func},h.defaultProps={className:void 0,children:void 0,href:void 0,onClick:void 0};var y=u.inject(function(e,t,r){var n=t.onClick,o=t.code,u=t.query,i=s(t,["onClick","code","query"]),a=r.router;return{href:i.href||a.getRoute(o)&&a.getRoute(o).href,onClick:function(e){n&&n(e),function(e){return function(e){return!!(e.shiftKey||e.altKey||e.metaKey||e.ctrlKey)}(e)||function(e){return e.button&&0!==e.button}(e)||e.defaultPrevented}(e)||(a.push(o,i,u),e.preventDefault())}}})(h);e.router=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.routes,o=e.path,u=void 0===o?"ui.router":o,i=e.getState,a=void 0===i?function(e){return e.ui.router}:i,s=t.router(n,{getState:a}),f=s.middleware,d=s.reducer,h=s.init;return{getDriver:function(e){return l({},Object.entries(t.actions).reduce(function(t,r){var n=p(r,2),o=n[0],u=n[1];return l({},t,c({},o,function(){return e.dispatch(u.apply(void 0,arguments))}))},{}),Object.entries(t.selectors(a)).reduce(function(t,r){var n=p(r,2),o=n[0],u=n[1],i=function(){return u(e.getState())};return["getRoute","getPathParam","getQueryParam","getParam"].includes(o)&&(i=function(){return u.apply(void 0,arguments)(e.getState())}),l({},t,c({},o,i))},{}))},getReducer:function(){return{path:u,reducer:d}},getEnhancer:function(){return r.applyMiddleware(f)},init:function(e){e.dispatch(h())}}},e.forRoute=d,e.Link=y,Object.defineProperty(e,"__esModule",{value:!0})});
